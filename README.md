# KuramotoMetastability
Codes and scripts for studying metastability in a Kuramoto system.  These codes, written in Julia, were used to generate the figures in the manuscript [*Metastability in the stochastic nearest-neighbor
Kuramoto model of coupled phase oscillators*](https://arxiv.org/abs/2412.15136) by Berglund, Medvedev, and Simpson.  Some of these codes were previously used to generate the figures in [*A numerical method for a nonlocal diffusion equation with additive noise*](https://link.springer.com/article/10.1007/s40072-022-00262-w) by Medvedev and Simpson.

This work was supported in part by US NSF DMS–2111278.

# Internal Julia Packages
Several Julia packages are described below.  These are known to work with Julia 1.10.x and 1.11.x.

## Classical Kuramoto
The `ClassicalKuramoto` package includes functions for computing the energy and its gradient in the classical setting.  By classical, we mean that
```math
\text{Energy} = E = \sum_{j\in \mathcal{N}_i} \frac{(-1)^{1+\alpha}}{4\pi} \cos(2\pi (u_j - u_i))
```
where, in the above expression:
* $\alpha = 0$ (attractive) or $\alpha =1$ (repulsive) coupling
* $\mathcal{N}_i$ is the neighbor set of site $i$.  This can be specified in terms of `k`, the interaction range, such that all sites within distance `k` are in the neighbor set or by specifying an adjacency matrix `K`, which has nonzero entries to indicate neighbors.  The relevant functions are `energy` and `grad_energy!`

## Generalized Kuramoto
The `GeneralizedKuramoto` package allows for more general flows of the form
```math
du_i = f(t, u_i)dt + \sum_{j\in \mathcal{N}_i} K_{ij}S(u_i,u_j) + dW_i.
```
In the above expressions,
* $f$ is the self interaction term
* $K$ is the adjacency matrix
* $S$ is the nonlinear coupling function
* $W$ is a Gaussian process

This package performs the actual time stepping (`Euler` and `EulerMaruyama`) and requires the specification of the above details in order to run.  As this work focuses on the computation of first passage times, `EulerMaruyamaFPT` is also included, which requires the user to provide a function that determines when a realization has exited a user specified set.

## Graph Matrices
The `GraphMatirces` package includes some utility functions for computing dense and sparse representations, in terms of the interaction matrices, givne some interaction range.  See `discrete_knn_spmatrix`.

## QProcesses
The `QProcesses` package includes functions for sampling Gaussian processes by FFT methods (via `FFTW`) including white noise.  See, for instance, `IsoGaussian`
 and `RealInvLaplacianPBC`.

## Twisted States
The `TwistedStates` package includes utility functions for constructin twisted state solutions, including `construct_q_twisted`.

# Job Scripts
Ensembles of realizations were generated on the [Drexel University Picotte Computing Cluster](https://drexel.edu/core-facilities/facilities/research-computing/picotte/) with slurm scripts (in the `scripts` folder).  Included are two examples:
* `distfpt.jl` and `distfpt.sh` uses the `Distributed` package for sampling ensembles of first passage times out of a given state.
* `nonlocal.jl` and `nonlocal.sh` use the string methods (along with the [`StringMethod.jl`](https://github.com/gideonsimpson/StringMethod.jl) package) to compute energy barriers and estimate prefactors in Eyring-Kramers.  These ensembles are generated using [multi-threading](https://docs.julialang.org/en/v1/manual/multi-threading/) instead of [multiprocessing](hthttps://docs.julialang.org/en/v1/manual/distributed-computing/).



# Jupyter Notebooks
The included Jupyter notebooks (in the `notebooks` folder) demonstrate these codes and show how data can be visualized.

* `Sequential Transitions.ipynb` - This notebook runs a single realization showing a sequence of transitions between different twisted states.
* `Kramers Rates.ipynb` – This notebook shows how first passage data, generated from the `distfpt.jl` script, can be loaded in and compared with Eyring-Kramers estimates.
* `Nearest Neighbor Convergence.ipynb` – This notebook shwos the convergence of our reported results on the Eyring-Kramers formulas in the $n\to \infty$ limit.
* `Nonlocal Experiments` – This notebook loads in data for problems with greater than nearest neighbor interaction range (generated by the `nonlocal.jl` script), and examines trends in their inferred Eyring-Kramers reaction rate contstants.